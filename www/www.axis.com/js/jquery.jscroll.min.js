/*
(function($){$.fn.jScroll=function(e){var f=$.extend({},$.fn.jScroll.defaults,e);return this.each(function(){var a=$(this);var b=$(window);var c=new location(a);b.scroll(function(){a.hide().stop().animate(c.getMargin(b),f.speed,function(){a.show()})})});function location(d){this.min=d.offset().top;this.originalMargin=parseInt(d.css("margin-top"),10)||0;this.getMargin=function(a){var b=d.parent().offset().top;var c=this.originalMargin;if(a.scrollTop()>=this.min){c=c+f.top+a.scrollTop()-this.min;}if(c>b){c=b;}return({"marginTop":c+'px'})}}};$.fn.jScroll.defaults={speed:"slow",top:10}})(jQuery);
*/

//####################################################################################
//#######                                                                      #######
//####### Plugin:      jScroll                                                 #######
//####### Author:      William Duffy                                           #######
//####### Website:     http://www.wduffy.co.uk/jScroll                         #######
//####### Version:     1.1	                                                    #######
//#######                                                                      #######
//####### Copyright (c) 2011, William Duffy - www.wduffy.co.uk                 #######
//#######                                                                      #######
//####### Permission is hereby granted, free of charge, to any person          #######
//####### obtaining a copy of this software and associated documentation       #######
//####### files (the "Software"), to deal in the Software without              #######
//####### restriction, including without limitation the rights to use,         #######
//####### copy, modify, merge, publish, distribute, sublicense, and/or sell    #######
//####### copies of the Software, and to permit persons to whom the            #######
//####### Software is furnished to do so, subject to the following             #######
//####### conditions:                                                          #######
//#######                                                                      #######
//####### The above copyright notice and this permission notice shall be       #######
//####### included in all copies or substantial portions of the Software.      #######
//#######                                                                      #######
//####### THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,      #######
//####### EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES      #######
//####### OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND             #######
//####### NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT          #######
//####### HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,         #######
//####### WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING         #######
//####### FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR        #######
//####### OTHER DEALINGS IN THE SOFTWARE.                                      #######
//#######                                                                      #######
//####################################################################################
(function($) {

 // Public: jScroll Plugin
 $.fn.jScroll = function(options) {

     var opts = $.extend({}, $.fn.jScroll.defaults, options);

     return this.each(function() {
			var $element = $(this);
			var $window = $(window);
			var locator = new location($element);

			$window.scroll(function() {
				$element
					.hide()
					.stop()
					.animate(locator.getMargin($window), opts.speed,function(){$element.show();});
			});
     });

		// Private
		function location($element)
		{
			this.min = $element.offset().top;
			this.originalMargin = parseInt($element.css("margin-top"), 10) || 0;

			this.getMargin = function ($window)
			{
				//var max = $element.parent().height() - $element.outerHeight();
				if($window.scrollTop() < 1){
					var max = $element.parent().offset().top;
				}else{
					var max = $element.parent().height() - $element.outerHeight();
					if(max < $element.parent().offset().top){
						max = $element.parent().offset().top;
					}
				}

				var margin = this.originalMargin;

				if ($window.scrollTop() >= this.min){
					margin = margin + opts.top + $window.scrollTop() - this.min;
				}
				//alert('margin: ' + margin + ' max:' + max);
				if (margin > max){
					margin = max;
				}

				return ({"marginTop" : margin + 'px'});
			}
		}

 };

 // Public: Default values
 $.fn.jScroll.defaults = {
     speed	:	"slow",
		top		:	10
 };

})(jQuery);